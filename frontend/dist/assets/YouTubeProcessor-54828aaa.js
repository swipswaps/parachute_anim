import{c as q,r,b as t,j as e,Y as R,B as j,F as z}from"./index-87f15445.js";import{A as D,a as G,b as V,c as k,C as K,L as g,I as y,t as O,i as Q}from"./timeUtils-a973ab9d.js";import{C as W,a as X,b as Z,c as ee,d as se,L as te,R as re}from"./card-61706360.js";import{u as L,v as P}from"./useApi-d84b8f62.js";/**
 * @license lucide-react v0.302.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ae=q("Clock",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["polyline",{points:"12 6 12 12 16 14",key:"68esgv"}]]),le=l=>{const a=/^.*((youtu.be\/)|(v\/)|(\/u\/\w\/)|(embed\/)|(watch\?))([^#&?]*).*/,i=l.match(a);return i&&i[7].length===11?i[7]:null},U=(l,a="maxresdefault")=>`https://img.youtube.com/vi/${l}/${a}.jpg`,M=l=>/^(https?:\/\/)?(www\.)?(youtube\.com|youtu\.be)\/.+$/.test(l);function me({onProcessComplete:l}){const[a,i]=r.useState(""),[m,x]=r.useState("00:00:00"),[d,N]=r.useState(10),[o,h]=r.useState(null),[T,b]=r.useState(""),[A,f]=r.useState(""),[S,v]=r.useState(0),[u,w]=r.useState(null),[p,Y]=r.useState(null),{loading:c,error:I,data:F,execute:H,reset:$}=L(P.processYouTubeVideo,{onSuccess:s=>{Y(s.job_id),s.status==="completed"&&l&&l(s)}}),J=F!==null,C=r.useCallback(s=>{if(h(null),b(""),f(""),!s||!M(s))return;const n=le(s);n&&(h(n),f(U(n)),b(`YouTube Video (${n})`))},[]);r.useEffect(()=>{C(a)},[a,C]);const{execute:E}=L(P.getJobStatus,{onSuccess:s=>{const{status:n,progress:B}=s;v(B||0),n==="completed"&&l&&l(s)},onError:(s,n)=>console.error("Error polling job status:",n)});r.useEffect(()=>{if(p&&c){const s=setInterval(()=>{E(p)},5e3);return w(s),()=>clearInterval(s)}},[p,c,E]),r.useEffect(()=>()=>{u&&clearInterval(u)},[u]);const _=()=>a?M(a)?o?Q(m)?d<=0?(setError("Duration must be greater than 0"),!1):d>300?(setError("Duration cannot exceed 5 minutes (300 seconds)"),!1):!0:(setError("Invalid start time format. Use HH:MM:SS, MM:SS, or seconds"),!1):(setError("Could not extract YouTube video ID"),!1):(setError("Please enter a valid YouTube URL"),!1):(setError("Please enter a YouTube URL"),!1);return t(W,{children:[t(X,{children:[e(Z,{children:"Process YouTube Video"}),e(ee,{children:"Enter a YouTube URL to create a 3D model"})]}),t(se,{children:[I&&t(D,{variant:"destructive",className:"mb-4",children:[e(G,{className:"h-4 w-4"}),e(V,{children:"Error"}),e(k,{children:I})]}),J&&t(D,{className:"mb-4",children:[e(K,{className:"h-4 w-4"}),e(V,{children:"Success"}),e(k,{children:"Your YouTube video has been processed successfully."})]}),t("div",{className:"space-y-4",children:[t("div",{className:"space-y-2",children:[e(g,{htmlFor:"youtubeUrl",children:"YouTube URL"}),t("div",{className:"flex",children:[e("div",{className:"bg-gray-100 p-2 rounded-l-md flex items-center",children:e(R,{className:"h-5 w-5 text-red-600"})}),e(y,{id:"youtubeUrl",type:"url",placeholder:"https://www.youtube.com/watch?v=...",value:a,onChange:s=>i(s.target.value),className:"rounded-l-none",disabled:c})]})]}),o&&t("div",{className:"bg-gray-50 rounded-md overflow-hidden",children:[t("div",{className:"relative",children:[e("img",{src:A,alt:T,className:"w-full h-auto object-cover",onError:s=>{s.target.src=U(o,"default")}}),e("div",{className:"absolute inset-0 bg-black bg-opacity-20 flex items-center justify-center",children:e(R,{className:"h-12 w-12 text-white opacity-80"})})]}),t("div",{className:"p-3",children:[e("h3",{className:"font-medium truncate",children:T}),t("p",{className:"text-xs text-gray-500 mt-1",children:["YouTube ID: ",o]})]})]}),t("form",{onSubmit:async s=>{s.preventDefault(),_()&&(v(0),H({youtube_url:a,start_time:O(m),duration:d}))},className:"space-y-4",children:[t("div",{className:"grid grid-cols-2 gap-4",children:[t("div",{className:"space-y-2",children:[e(g,{htmlFor:"startTime",children:"Start Time (HH:MM:SS, MM:SS, or seconds)"}),e(y,{id:"startTime",value:m,onChange:s=>x(s.target.value),disabled:c})]}),t("div",{className:"space-y-2",children:[e(g,{htmlFor:"duration",children:"Duration (seconds)"}),e(y,{id:"duration",type:"number",min:"1",max:"300",value:d,onChange:s=>N(parseInt(s.target.value)),disabled:c})]})]}),t("div",{className:"flex space-x-2",children:[e(j,{type:"submit",className:"flex-1",disabled:!o||c,children:c?t(z,{children:[e(te,{className:"mr-2 h-4 w-4 animate-spin"}),"Processing..."]}):"Process YouTube Video"}),e(j,{type:"button",variant:"outline",onClick:()=>{i(""),x("00:00:00"),N(10),h(null),b(""),f(""),v(0),Y(null),$(),u&&(clearInterval(u),w(null))},disabled:c,children:e(re,{className:"h-4 w-4"})})]}),c&&t("div",{className:"mt-4 space-y-2",children:[t("div",{className:"flex items-center justify-between text-sm",children:[t("div",{className:"flex items-center",children:[e(ae,{className:"h-4 w-4 mr-1 text-blue-500"}),e("span",{children:"Processing video..."})]}),t("span",{children:[S,"%"]})]}),e("div",{className:"w-full bg-gray-200 rounded-full h-2.5",children:e("div",{className:"bg-blue-600 h-2.5 rounded-full transition-all duration-300",style:{width:`${S}%`}})}),e("p",{className:"text-xs text-gray-500 italic",children:"This may take several minutes depending on the video length."})]})]})]})]})]})}export{me as default};
